<form (ngSubmit)="saveAllSettings()" #displayForm="ngForm" id="displaySetting">
  <p>Customize your display settings to improve visibility and adapt to various
    lighting conditions.</p>

     <mat-accordion>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Night Mode
          </mat-panel-title>
          @if (!isPhonePortrait().matches) {
            <mat-panel-description [hidden]="isPhonePortrait().matches">
              Adjust night mode settings to enhance visibility in low-light environments.
            </mat-panel-description>
          }
        </mat-expansion-panel-header>
        <mat-slide-toggle class="full-width sliders"
          (change)="isAutoNightModeSupported($event)"
          name="autoNightMode"
          [(ngModel)]="autoNightMode">
          Automatically activate day and night modes based on sun phases.
        </mat-slide-toggle>
        <mat-slide-toggle
          #redNightModeToggle
          class="full-width sliders"
          [(ngModel)]="isRedNightMode"
          name="redNightMode">
          Enable red-only night mode.
        </mat-slide-toggle>
        <div style="padding-left: 10px;">
          <br/>
          <span class="mat-body-medium">Adjust Night Mode Brightness</span>
          <br/>
          <mat-slider min="0" max="1" step="0.01" [disabled]="redNightModeToggle.checked" discrete>
            <input #inputBrightness matSliderThumb
              [value]="nightBrightness()"
              (input)="setBrightness(+inputBrightness.value)"
              [disabled]="redNightModeToggle.checked">
          </mat-slider>
        </div>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Theme
          </mat-panel-title>
          @if (!isPhonePortrait().matches) {
            <mat-panel-description>
              Choose your preferred high-contrast theme.
            </mat-panel-description>
          }
        </mat-expansion-panel-header>
        <mat-slide-toggle class="full-width"
          [(ngModel)]="isLightTheme"
          name="isLightTheme">
            Enable light theme for brighter display settings.
        </mat-slide-toggle>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Chartplotter Mode
          </mat-panel-title>
          @if (!isPhonePortrait().matches) {
            <mat-panel-description>
              Configure persistent dual‑panel chart & dashboards layout.
            </mat-panel-description>
          }
        </mat-expansion-panel-header>
        <mat-slide-toggle #isFskShellEnabled class="full-width"
          name="freeboardShellEnabled"
          [(ngModel)]="splitShellEnabled">
          Enable Freeboard‑SK dual‑panel Chartplotter Mode.
        </mat-slide-toggle>
          <mat-form-field class="optional-field">
            <mat-label>Freeboard-SK panel side</mat-label>
            <mat-select
              name="splitShellSide"
              [(ngModel)]="splitShellSide"
              [disabled]="!isFskShellEnabled.checked">
              <mat-option value="left">Left side</mat-option>
              <mat-option value="right">Right side</mat-option>
            </mat-select>
          </mat-form-field>
          <mat-slide-toggle #isFskShellSwipeEnabled class="optional-field full-width"
            name="freeboardShellSwipeEnabled"
            [(ngModel)]="splitShellSwipeDisabled"
            [disabled]="!isFskShellEnabled.checked">
            Disable swipe gestures over chart panel.
        </mat-slide-toggle>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Remote Control
          </mat-panel-title>
          @if (!isPhonePortrait().matches) {
            <mat-panel-description>
              Enable remote dashboard management between KIP instances.
            </mat-panel-description>
          }
        </mat-expansion-panel-header>
        <mat-slide-toggle #isRemoteControlCb class="full-width"
          [(ngModel)]="isRemoteControl"
          name="isRemoteControl">
            Allow this KIP dashboard to be changed remotely by other KIP instances.
        </mat-slide-toggle>
        <mat-form-field class="optional-field">
          <mat-label>Instance Name</mat-label>
          <input matInput
            (ngModelChange)="displayForm.form.markAsDirty()"
            name="instanceName"
            placeholder="Ex. Mast"
            [(ngModel)]="instanceName"
            [ngModelOptions]="{ standalone: true }"
            [disabled]="!isRemoteControlCb.checked"
            required>
        </mat-form-field>
      </mat-expansion-panel>
    </mat-accordion>
  <div class="formActionFooter">
    <mat-divider class="formActionDivider"></mat-divider>
    <button mat-flat-button type="submit" class="formActionButton" [disabled]="!displayForm.form.dirty">Save</button>
  </div>
</form>
