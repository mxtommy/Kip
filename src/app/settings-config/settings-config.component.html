<mat-tab-group>
  <mat-tab label="Remote Storage">
    <p>Recommended Reading: To understand configuration management and storage options, consult the Configuration Management Help section.</p>
    <a href="/#/help">Go to Kip Help</a>
    <div class="config-row">
      <div class="config-column">
        <mat-card>
          <form>
            Load Config from Server <div *ngIf="!supportApplicationData" class="warningText">Node Server version greater than 1.27.0 required</div>
            <mat-form-field class="almost-full-width">
              <mat-label>Select Configuration Name</mat-label>
              <mat-select required [formControl]="configLoad">
                <mat-option *ngFor="let config of serverConfigList" [value]="config">
                  {{config.scope}} / {{config.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-card-actions align="end">
              <button mat-raised-button type="button" color="warn" [disabled]="!(configLoad.valid && configLoad.dirty) && supportApplicationData" (click)='restoreRemoteServerConfig()'>Load</button>
            </mat-card-actions>
          </form>
        </mat-card>
      </div>
      <div class="config-column">
        <mat-card>
          <form name="saveConfigForm" (ngSubmit)="saveLocalConfigToserver()" #saveConfigForm="ngForm">
            Save Config to Server<div *ngIf="!supportApplicationData" class="warningText">Node Server version greater than 1.27.0 required</div>
              <mat-form-field class="almost-full-width">
                <mat-label>Configuration Name</mat-label>
                <input matInput name="serverConfigName" placeholder="Enter a name for the configuration" [(ngModel)]="configName" [ngModelOptions]="{standalone: false}" required>
                <mat-error>
                  You must provide a name for the configuration to save it
                </mat-error>
              </mat-form-field>
              <div *ngIf="!hasToken">Writing to the server requires user Sign in or a Device token</div>
              <div *ngIf="hasToken">
                Select save scope:
                <div *ngIf="isTokenTypeDevice; then thenBlock else elseBlock"></div>
                  <ng-template #thenBlock>
                    <mat-radio-group aria-label="Scope" [formControl]="configScope">
                      <mat-radio-button value="global" disabled="false">Global</mat-radio-button>
                    </mat-radio-group>
                  </ng-template>
                  <ng-template #elseBlock>
                    <mat-radio-group aria-label="Scope" [formControl]="configScope">
                      <mat-radio-button value="user" disabled="false">User</mat-radio-button>
                      <mat-radio-button value="global" disabled="false">Global (needs Admin rights)</mat-radio-button>
                    </mat-radio-group>
                  </ng-template>
              </div>
              <mat-card-actions align="end">

                <button mat-raised-button type="submit" [disabled]="!hasToken || !saveConfigForm.valid" color="accent">Save</button>
              </mat-card-actions>
          </form>
        </mat-card>
      </div>
    </div>
  </mat-tab>
  <mat-tab label="Live Configuration">
    <p>The Live Configuration is the active in-memory configuration. It represent the current state of the application. You can edit those values by configuration areas and save them to persist your changes to the browser's Local Storage. If you save your changes, the app will reload with your changes, else your changes will not be applied.</p>
    <form name="appSettingsForm" (ngSubmit)="saveToLocalConfig('appConfig')">
      <mat-expansion-panel>
        <mat-expansion-panel-header>Application</mat-expansion-panel-header>
        <mat-form-field class="config-size">
            <textarea name="jsonConf" class="textheight" matInput placeholder="Raw Application JSON configuration" wrap="off" [(ngModel)]="appJSONConfig"></textarea>
        </mat-form-field>
        <mat-action-row>
          <button mat-raised-button type="submit" color="accent">Save Edits</button>
        </mat-action-row>
      </mat-expansion-panel>
    </form>

    <form name="connectionSettingsForm" (ngSubmit)="saveToLocalConfig('connectionConfig')">
      <mat-expansion-panel>
        <mat-expansion-panel-header>Server Connection</mat-expansion-panel-header>
        <mat-form-field class="config-size">
            <textarea name="jsonConf" class="textheight" matInput placeholder="Raw Application JSON configuration" wrap="off" [(ngModel)]="connectionJSONConfig"></textarea>
        </mat-form-field>
        <mat-action-row>
          <button mat-raised-button type="submit" color="accent">Save Edits</button>
        </mat-action-row>
      </mat-expansion-panel>
    </form>

    <form name="widgetSettingsForm" (ngSubmit)="saveToLocalConfig('widgetConfig')">
      <mat-expansion-panel>
        <mat-expansion-panel-header>Widgets</mat-expansion-panel-header>
        <mat-form-field class="config-size">
            <textarea name="jsonConf" class="textheight" matInput placeholder="Raw Widget JSON configuration" wrap="off" [(ngModel)]="widgetJSONConfig"></textarea>
        </mat-form-field>
        <mat-action-row>
          <button mat-raised-button type="submit" color="accent">Save Edits</button>
        </mat-action-row>
      </mat-expansion-panel>
    </form>
    <form name="layoutSettingsForm" (ngSubmit)="saveToLocalConfig('layoutConfig')">
      <mat-expansion-panel>
        <mat-expansion-panel-header>Layouts</mat-expansion-panel-header>
        <mat-form-field class="config-size">
            <textarea name="jsonConf" class="textheight" matInput placeholder="Raw Layout JSON configuration" wrap="off" [(ngModel)]="layoutJSONConfig"></textarea>
        </mat-form-field>
        <mat-action-row>
          <button mat-raised-button type="submit" color="accent">Save Edits</button>
        </mat-action-row>
      </mat-expansion-panel>
    </form>
    <form name="themeSettingsForm" (ngSubmit)="saveToLocalConfig('themeConfig')">
      <mat-expansion-panel>
        <mat-expansion-panel-header>Theme</mat-expansion-panel-header>
        <mat-form-field class="config-size">
            <textarea name="jsonConf" class="textheight" matInput placeholder="Raw Theme JSON configuration" wrap="off" [(ngModel)]="themeJSONConfig"></textarea>
        </mat-form-field>
        <mat-action-row>
          <button mat-raised-button type="submit" color="accent">Save Edits</button>
        </mat-action-row>
      </mat-expansion-panel>
    </form>
    <form name="zoneSettingsForm" (ngSubmit)="saveToLocalConfig('zonesConfig')">
      <mat-expansion-panel>
        <mat-expansion-panel-header>Zones</mat-expansion-panel-header>
        <mat-form-field class="config-size">
            <textarea name="jsonConf" class="textheight" matInput placeholder="Raw Layout JSON configuration" wrap="off" [(ngModel)]="zonesJSONConfig"></textarea>
        </mat-form-field>
        <mat-action-row>
          <button mat-raised-button type="submit" color="accent">Save Edits</button>
        </mat-action-row>
      </mat-expansion-panel>
    </form>
  </mat-tab>

  <mat-tab label="Demo/Erase">
    <mat-card>
      <mat-card-actions align="end">
        <button mat-raised-button type="button" color="warn" (click)='loadDemoConfig()'>Load Demo Config</button>
        <button mat-raised-button type="button" color="warn" (click)='resetConfigToDefault()'>Erase Config</button>
      </mat-card-actions>
    </mat-card>
  </mat-tab>

</mat-tab-group>




